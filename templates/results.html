<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emotion Prediction Results</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        body {
            background-color: #f8f9fa;
            padding-top: 50px;
            font-family: sans-serif;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        h1 {
            text-align: center;
            margin-bottom: 20px;
        }

        #execution-plan {
            width: 100%;
            height: 400px; /* Adjust height as needed */
            border: 1px solid #ccc;
            margin-top: 20px;
        }

        .node-label {
            font-size: 12px;
            font-weight: bold;
        }

        .edge-label {
            font-size: 10px;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.22.1/cytoscape.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>Emotion Prediction Results</h1>

        <div id="execution-plan"></div>

        <p>Predicted Emotion: <strong>{{ execution_plan.predicted_emotion.capitalize() }}</strong></p>
        <p>Original Image Path: {{ execution_plan.original_image_path }}</p>
        <p>Preprocessed Image Shape: {{ execution_plan.preprocessed_shape }}</p>
        <p>Model Architecture: {{ execution_plan.model_architecture }}</p>
        <p>All Emotion Probabilities: {{ execution_plan.all_emotions_probabilities }}</p>

        <a href="/" class="btn btn-primary">Try Another Image</a>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var cy = cytoscape({
                container: document.getElementById('execution-plan'),
                elements: [
                    { data: { id: 'upload', label: 'Uploaded Image' }, classes: 'node' },
                    { data: { id: 'grayscale', label: 'Grayscale' }, classes: 'node' },
                    { data: { id: 'resize', label: 'Resize' }, classes: 'node' },
                    { data: { id: 'expand_dims', label: 'Expand Dims' }, classes: 'node' },
                    { data: { id: 'normalize', label: 'Normalize' }, classes: 'node' },
                    { data: { id: 'model_input', label: 'Model Input' }, classes: 'node' },
                    { data: { id: 'model', label: 'Model', shape: 'roundrectangle' }, classes: 'node' },
                    { data: { id: 'output', label: 'Output' }, classes: 'node' },

                    { data: { source: 'upload', target: 'grayscale', label: 'Load' }, classes: 'edge' },
                    { data: { source: 'grayscale', target: 'resize', label: 'Convert' }, classes: 'edge' },
                    { data: { source: 'resize', target: 'expand_dims', label: 'Resize' }, classes: 'edge' },
                    { data: { source: 'expand_dims', target: 'normalize', label: 'Expand' }, classes: 'edge' },
                    { data: { source: 'normalize', target: 'model_input', label: 'Normalize' }, classes: 'edge' },
                    { data: { source: 'model_input', target: 'model', label: 'Feed' }, classes: 'edge' },
                    { data: { source: 'model', target: 'output', label: 'Predict' }, classes: 'edge' }
                ],
                style: [
                    {
                        selector: '.node',
                        style: {
                            'background-color': '#666',
                            'label': 'data(label)',
                            'width': '60px',
                            'height': '60px',
                            'text-valign': 'center',
                            'text-halign': 'center',
                            'font-size': '10px',
                            'color': 'white'
                        }
                    },
                    {
                        selector: '.node[shape="roundrectangle"]',
                        style: {
                            'shape': 'roundrectangle',
                            'width': '80px',
                            'height': '80px'
                        }
                    },
                    {
                        selector: '.edge',
                        style: {
                            'width': 2,
                            'line-color': '#888',
                            'target-arrow-color': '#888',
                            'target-arrow-shape': 'triangle',
                            'curve-style': 'bezier',
                            'label': 'data(label)',
                            'font-size': '10px'
                        }
                    }
                ],
                layout: {
                    name: 'grid',
                    rows: 2
                }
            });
        });
    </script>
</body>
</html>